# -*- coding: utf-8 -*-
# <nbformat>3.0</nbformat>

# <codecell>

# Creates list of user pairs

import itertools  

a = [1,2,3,4,5,6,7,10,11,13,14,15,16,18,20,21,22,23,24,25,26,27,28,29,30,31,32,33,34,35,36,37,38,40,41,42,43,44,45,46,48,49,50,51,52,53,54,56,57,58,61,62,63,64,65,66,67,68,69,70,71,72,73,77,78,80,81,82,83,84,85,86,87,88,89,90,92,93,94,95,96,97,98,99,100,102,103,104,105,106,107,108,109,110,111,112,113,114,115,116,117,118,119,121,122,123,124,125,126,127,128,130,131,132,133,134,135,136,137,138,140,141,142,144,146,148,149,151,152,153,154,155,157,158,159,160,161,162,163,164,165,166,168,169,170,171,172,173,174,175,177,178,179,180,181,182,183,184,185,187,188,189,190,191,192,193,195,196,197,198,199,200,202,203,204,206,207,209,211,212,213,214,215,217,219,220,221,222,223,224,225,226,227,228,229,230,232,233,234,235,236,237,238,239,240,241,242,243,244,245,246,247,248,249,250,251,253,254,256,257,258,259,260,261,262,263,264,265,266,267,268,269,270,271,272,273,274,275,276,277,278,279,280,282,283,284,285,286,287,288,289,290,291,292,293,294,295,296,297,299,300,301,302,303,304,305,306,307,308,309,310,311,313,315,316,317,319,320,321,322,323,326,327,330,331,332,334,335,336,337,338,339,340,341,342,343,344,345,346,347,348,349,350,351,352,353,354,355,356,357,358,359,360,361,362,363,365,366,367,368,369,371,372,373,374,375,376,377,379,380,381,383,384,385,386,387,388,389,390,391,392,393,394,395,396,397,398,399,400,401,402,404,405,406,408,409,410,411,412,413,414,415,416,417,418,419,421,422,423,424,425,427,428,429,430,431,432,433,434,435,436,437,438,439,440,441,442,443,444,445,446,447,448,449,450,451,452,454,455,456,457,459,460,461,463,464,466,467,469,470,471,472,473,474,475,476,478,479,480,481,482,483,484,485,486,487,488,489,491,492,493,494,496,497,498,499,500,501,502,503,504,505,507,508,509,510,511,512,513,514,515,516,517,518,519,520,522,525,526,527,528,529,530,531,532,535,536,537,538,539,540,541,542,543,544,546,547,548,549,550,551,552,553,554,555,556,557,558,559,560,561,562,563,564,565,566,567,569,570,572,573,574,575,576,577,579,580,581,582,583,584,585,586,587,588,589,590,591,592,593,595,596,597,598,601,602,603,604,605,606,608,609,610,611,612,613,614,615,616,617,618,619,620,621,622,623,624,625,626,628,629,630,631,632,633,635,636,637,639,640,641,642,643,644,645,646,647,648,649,650,652,653,654,655,656,657,658,659,660,661,662,663,664,665,666,668,669,670,671,672,673,674,675,676,677,678,679,680,681,682,683,684,685,686,687,688,689,690,691,692,693,695,696,697,699,700,701,702,703,704,705,706,707,708,710,711,712,714,715,716,717,718,720,721,722,723,724,725,726,727,728,729,730,731,732,733,734,735,736,737,738,739,740,741,742,743,744,745,746,747,748,749,750,751,752,753,754,755,756,757,758,759,760,761,762,764,765,766,768,770,771,772,773,774,775,776,780,781,782,783,784,785,787,789,790,791,792,793,794,796,797,798,799,800,801,802,803,804,805,806,807,808,809,810,811,812,814,815,816,817,818,819,820,821,822,823,824,826,827,828,829,830,831,832,833,834,835,836,837,839,840,841,842,843,844,845,846,847,849,850,851,852,853,854,856,860,861,862,863,864,865,866,867,868,869,870,871,872,873,874,875,876,877,878,879,880,881,882,883,884,885,886,887,888,889,890,892,893,894,895,896,897,898,899,900,902,903,904,905,906,907,908,909,910,911,913,915,917,918,919,920,921,922,924,925,927,928,929,931,933,934,935,936,937,938,939,941,942,943]
pairlist = list(itertools.combinations(a,2))

# <codecell>

# number of pairs is 343K
#len(pairlist)

# <codecell>

# user_data dictionary where keys are user ids and the value is a list of data about the users. The first item is the users age range, the second item is the gender (male = 0), and the last two are the users location lat and long
user_data = {1: [3,0,20,32.21,-110.88],2: [6,1,14,37.41,-122.05],3: [3,0,21,30.16,-81.7],4: [3,0,20,41.57,-83.65],5: [4,1,14,40.43,-79.97],6: [5,0,7,47.61,-122.33],7: [6,0,1,34.29,-118.5],10: [6,0,10,33.86,-118.05],11: [4,1,14,33.82,-84.32],13: [5,0,4,34,-81.03],14: [5,0,18,44.94,-93.1],15: [5,1,4,44.9,-122.92],16: [3,0,6,40.58,-74.14],18: [4,1,14,36.17,-86.78],20: [5,1,9,38.66,-121.37],21: [3,0,21,33.95,-84.54],22: [3,0,21,38.22,-85.74],23: [4,1,2,42.24,-83.62],24: [3,1,2,38.28,-122],25: [4,0,5,44.94,-93.1],26: [5,0,5,39.2,-76.85],27: [5,1,11,33.77,-84.29],28: [4,0,21,45.11,-93.39],29: [5,0,15,37.41,-122.05],30: [1,0,19,44.96,-93.26],31: [3,0,2,40.71,-73.99],32: [3,1,19,30.26,-97.74],33: [3,0,19,35.91,-79.08],34: [4,1,1,36.99,-85.92],35: [3,1,9,37.54,-87.98],36: [2,1,19,34.5,-120.12],37: [3,0,19,44.94,-93.1],38: [3,1,14,44.46,-89.54],40: [4,0,18,35.92,-79.04],41: [4,0,5,40.55,-105.06],42: [4,0,1,40.8,-76.86],43: [3,1,11,39.02,-77.19],44: [3,0,20,39.77,-86.14],45: [3,0,15,41.59,-94.19],46: [3,1,12,41.32,-85.84],48: [5,0,1,41.5,-74.02],49: [3,1,19,32.75,-97.33],50: [3,0,21,41.65,-91.53],51: [3,0,4,42.12,-80.08],52: [2,1,19,44.94,-93.1],53: [3,0,15,44.96,-93.26],54: [3,0,7,38.9,-94.68],56: [3,0,11,39.77,-86.14],57: [2,0,13,40.88,-111.82],58: [3,0,15,41.65,-91.53],61: [4,0,5,34.2,-84.13],62: [3,1,1,45.51,-122.64],63: [4,0,12,32.79,-96.76],64: [4,0,4,39.98,-82.98],65: [6,1,4,42.31,-84.02],66: [3,0,19,40.55,-105.06],67: [2,0,19,41.84,-87.79],68: [2,0,19,38.03,-78.48],69: [3,0,5,44.76,-93.27],70: [3,0,5,42.11,-88.04],71: [4,0,18,47.72,-122.2],72: [5,1,1,35.67,-97.41],73: [3,0,19,37.17,-82.73],77: [4,0,20,34.72,-81.62],78: [3,0,1,40.1,-88.2],80: [4,1,1,41.69,-91.6],81: [3,0,19,39.3,-76.61],82: [6,0,15,38.03,-78.48],83: [5,0,14,41.31,-81.74],84: [4,0,7,45.11,-93.39],85: [6,0,4,38.89,-77.03],86: [3,0,1,40.25,-85.67],87: [5,0,1,39.54,-119.84],88: [5,1,11,40.66,-73.41],89: [5,1,1,41.26,-96.01],90: [7,0,4,29.57,-97.96],92: [4,0,6,40.55,-105.06],93: [5,0,7,37.5,-77.63],94: [3,0,19,31.75,-93.09],95: [4,0,1,40.95,-73.82],96: [3,1,2,32.79,-96.76],97: [5,0,2,47.55,-122.14],98: [5,1,7,33.99,-118.46],99: [3,0,19,38.63,-90.24],100: [4,0,7,33.86,-118.39],102: [4,0,15,33.23,-84.82],103: [3,0,19,44.94,-93.1],104: [3,0,19,44.94,-93.1],105: [3,0,5,37.41,-122.05],106: [7,0,16,44.94,-93.1],107: [4,0,18,41.48,-87.68],108: [5,0,4,38.63,-90.24],109: [3,0,14,44.96,-93.26],110: [2,0,19,30.6,-96.31],111: [6,0,5,33.81,-118.03],112: [4,0,17,41.83,-87.68],113: [5,0,7,37.23,-121.95],114: [3,0,15,33.1,-96.66],115: [4,0,5,40.27,-76.88],116: [5,0,8,45.52,-122.64],117: [3,0,19,41.4,-80.38],118: [3,0,1,34.09,-118.41],119: [4,0,15,38.81,-97.61],121: [6,0,11,59.4,-151.32],122: [4,1,21,38.87,-77.1],123: [5,1,2,38.89,-77.03],124: [4,0,19,41.83,-87.68],125: [4,0,10,38.87,-77.1],126: [3,1,10,38.89,-77.03],127: [4,0,13,34,-96.72],128: [3,1,12,38.89,-77.03],130: [3,0,13,41.89,-88.75],131: [6,1,1,40.43,-79.97],132: [3,0,14,37.8,-122.27],133: [6,0,5,30.11,-97.3],134: [4,0,15,39.76,-104.87],135: [3,0,19,35.62,-87.04],136: [6,0,14,44.66,-124.01],137: [6,0,4,41.19,-111.94],138: [5,0,3,43.06,-87.96],140: [4,1,19,30.29,-81.39],141: [5,0,15,32.35,-86.28],142: [2,0,14,42.31,-84.02],144: [6,0,15,39.01,-77.02],146: [5,0,2,47.59,-116.91],148: [4,0,5,45.52,-122.85],149: [4,1,12,39.83,-77.23],151: [4,1,1,42.27,-83.73],152: [4,1,4,42.19,-97.52],153: [3,0,19,41.83,-87.68],154: [3,0,19,43.07,-89.38],155: [4,1,14,40.64,-73.94],157: [6,0,5,30.44,-91.12],158: [6,0,4,35.82,-78.65],159: [3,1,19,44.84,-93.45],160: [3,0,15,38.9,-94.68],161: [6,0,10,44.94,-93.1],162: [3,0,2,40.09,-79.48],163: [5,0,1,45.54,-122.64],164: [5,0,8,39.59,-105.01],165: [3,1,14,43.07,-89.38],166: [5,0,4,44.94,-93.1],168: [5,0,14,39.57,-105.14],169: [6,1,14,43.07,-89.38],170: [6,1,8,33.95,-84.54],171: [5,1,4,30.26,-97.74],172: [6,0,12,38.87,-77.1],173: [6,0,14,38.82,-77.08],174: [4,1,1,42.03,-91.58],175: [3,1,18,39.69,-76.06],177: [3,0,15,39.95,-75.16],178: [3,0,14,42.96,-85.65],179: [2,0,6,39.08,-76.76],180: [3,1,1,42.04,-87.68],181: [3,0,7,39.3,-76.61],182: [4,0,15,28.04,-81.72],183: [4,0,18,35.98,-78.91],184: [4,0,11,32.69,-97.12],185: [6,1,11,44.03,-123.05],187: [3,0,4,40.79,-77.85],188: [5,0,19,33.36,-79.29],189: [4,0,2,37.3,-122.09],190: [4,0,1,39.61,-121.77],191: [4,0,1,37.38,-121.89],192: [5,0,4,33.78,-118.12],193: [3,0,19,47.11,-88.56],195: [5,0,18,35.55,-117.67],196: [5,0,21,44.94,-93.1],197: [6,0,20,33.04,-96.74],198: [3,1,19,44.96,-93.26],199: [4,0,21,40.04,-76.3],200: [5,0,15,35.29,-120.81],202: [5,1,4,42.04,-87.68],203: [3,1,19,30.45,-84.28],204: [6,1,11,41.09,-73.91],206: [2,1,19,42.62,-88.63],207: [4,0,12,32.86,-117.24],209: [4,1,4,32.22,-110.82],211: [7,0,17,29.67,-82.33],212: [5,1,4,40.95,-90.37],213: [4,0,7,44.93,-93.46],214: [3,1,11,40.64,-73.94],215: [4,0,15,38.79,-90.32],217: [3,0,14,40.87,-73],219: [4,0,15,39.98,-82.98],220: [4,0,11,29.45,-98.5],221: [2,0,19,38.47,-76.5],222: [3,0,15,35.72,-78.84],223: [2,1,19,40.44,-86.91],224: [4,1,4,41.28,-84.36],225: [6,1,1,47.91,-97.07],226: [3,0,19,32.74,-117.17],227: [5,0,7,41.83,-87.68],228: [3,1,19,38.83,-77.21],229: [3,1,11,38.03,-78.48],230: [3,1,19,43.32,-78.03],232: [5,0,18,64.9,-148.16],233: [4,0,5,45.67,-122.47],234: [7,0,16,37.86,-122.28],235: [4,0,4,38.3,-78.43],236: [5,1,21,43.06,-87.96],237: [5,0,1,38.63,-90.24],238: [5,1,1,41.47,-81.67],239: [4,0,2,38.65,-121.25],240: [3,1,4,38.95,-76.95],241: [3,1,19,38.89,-77.03],242: [4,0,4,32.08,-81.1],243: [4,0,4,42.04,-87.68],244: [3,0,20,40.55,-105.06],245: [3,0,19,44.94,-93.1],246: [2,0,19,35.18,-83.38],247: [3,0,5,38.99,-76.88],248: [3,0,19,36.17,-86.78],249: [3,0,19,40.79,-111.82],250: [3,0,7,37.34,-121.9],251: [3,0,3,33.62,-112],253: [3,1,11,38.03,-78.48],254: [5,0,4,36.69,-84.47],256: [4,1,13,32.28,-90],257: [2,0,19,29.76,-95.38],258: [2,1,19,30.66,-96.36],259: [3,0,19,42.73,-84.48],260: [5,1,2,40.95,-115.79],261: [3,0,1,33.38,-111.87],262: [2,1,19,29.45,-98.5],263: [5,0,15,44.84,-93.45],264: [4,1,21,34.03,-118.43],265: [3,0,7,40.22,-111.69],266: [7,1,1,30.26,-97.74],267: [3,0,5,43.54,-115.92],268: [3,0,5,40.14,-75.26],269: [4,1,11,39.98,-82.98],270: [2,1,19,38.63,-90.24],271: [6,0,5,38.06,-78.69],272: [4,0,18,43.07,-89.38],273: [6,1,14,40.71,-73.99],274: [3,1,19,44.96,-93.26],275: [4,0,5,32.97,-117.02],276: [3,0,19,36.98,-122.06],277: [4,1,1,44.96,-93.26],278: [4,1,11,33.77,-84.29],279: [4,0,15,33.49,-111.92],280: [4,1,11,38.03,-78.48],282: [3,0,1,38.89,-77.03],283: [3,0,15,44.92,-93.4],284: [5,0,7,33.47,-117.7],285: [3,0,15,43.07,-89.38],286: [3,0,19,40.43,-79.97],287: [3,0,17,32.83,-83.65],288: [4,0,12,37.55,-77.46],289: [2,0,13,37.78,-122.12],290: [5,0,5,34.52,-118.08],291: [2,0,19,41.47,-81.67],292: [4,1,15,37.86,-122.27],293: [3,0,21,41.84,-87.75],294: [4,0,20,32.77,-117.18],295: [4,0,4,41.6,-93.76],296: [5,1,1,40.79,-77.85],297: [3,1,4,47.67,-122.34],299: [3,0,3,38.63,-90.24],300: [3,1,15,44.94,-93.1],301: [3,0,19,44.96,-93.26],302: [5,0,4,28.82,-96.98],303: [2,0,19,42.44,-76.5],304: [3,1,19,33.56,-92.84],305: [3,0,15,37.36,-122.02],306: [5,0,14,35.46,-97.51],307: [3,0,19,44.96,-93.26],308: [7,0,16,36.95,-121.72],309: [5,0,18,30.44,-91.12],310: [4,0,4,34.12,-117.71],311: [4,0,20,35.22,-97.34],313: [5,0,12,42.18,-87.8],315: [4,0,4,41,-75.17],316: [5,1,14,29.76,-95.38],317: [3,0,1,43.04,-76.14],319: [4,0,15,38.85,-77.29],320: [2,0,19,37.23,-80.42],321: [5,1,4,44.96,-93.26],322: [3,0,19,42.52,-92.45],323: [3,0,19,39.95,-75.16],326: [5,0,1,40.43,-79.97],327: [3,0,19,40.74,-73.93],330: [4,1,4,28.04,-81.72],331: [4,0,6,34.29,-118.5],332: [3,0,19,38.04,-84.45],334: [4,0,11,33.76,-84.26],335: [5,0,7,27.84,-82.78],336: [3,0,17,36.97,-86.44],337: [4,0,18,41.01,-73.86],338: [4,1,11,45.66,-111.06],339: [4,0,10,35.97,-83.94],340: [5,0,5,39.59,-105.01],341: [2,1,19,41.07,-80.59],342: [3,1,14,47.55,-122.14],343: [5,0,5,33.94,-84.2],344: [4,1,11,37.76,-122.44],345: [3,1,11,37.76,-122.45],346: [4,0,14,32.39,-97.33],347: [2,0,19,34.09,-118.41],348: [3,1,19,38.94,-83.4],349: [7,0,16,40.47,-90.68],350: [4,0,19,44.9,-122.92],351: [7,0,4,46.45,-90.15],352: [4,1,15,44.94,-93.1],353: [3,0,18,34.21,-77.79],354: [3,1,11,42.24,-83.62],355: [3,0,19,42.09,-88.68],356: [4,1,9,33.61,-117.61],357: [3,0,7,47.73,-122.34],358: [5,0,4,40.71,-73.99],359: [3,0,19,40.1,-88.2],360: [6,0,14,47.5,-122],361: [3,0,19,41.29,-82.21],362: [4,1,9,33.34,-111.81],363: [3,0,19,35.67,-105.95],365: [3,0,10,38.89,-77.03],366: [3,1,19,42.71,-92.58],367: [2,0,19,35.06,-85.25],368: [2,0,19,32.69,-117.11],369: [3,0,19,34.2,-118.54],371: [4,0,5,47.63,-117.25],372: [3,1,19,38.96,-95.25],373: [3,1,14,44.94,-93.1],374: [4,0,7,30.26,-97.74],375: [2,0,6,35.82,-84.04],376: [3,1,14,40.71,-73.99],377: [3,0,19,40.62,-75.36],379: [5,0,15,47.68,-122.38],380: [4,0,5,44.94,-93.1],381: [4,0,2,37.83,-122.29],383: [5,0,1,32.79,-96.76],384: [6,0,15,39.09,-84.51],385: [4,0,21,40.71,-73.99],386: [4,0,17,39.98,-82.98],387: [4,0,6,35.06,-85.25],388: [4,0,14,32.35,-86.28],389: [5,1,21,43.71,-116.18],390: [5,1,21,33.5,-112.02],391: [3,0,19,40.33,-111.57],392: [6,0,21,46.85,-113.99],393: [2,0,19,43.49,-116.61],394: [3,0,1,21.3,-157.85],395: [5,0,14,41.6,-81.46],396: [6,0,5,37.77,-121.75],397: [2,0,19,35.92,-79.04],398: [5,0,14,42.07,-88.02],399: [3,0,14,34.06,-117.17],400: [4,1,1,29.45,-98.5],401: [5,1,8,40.65,-111.88],402: [4,0,5,37.3,-122],404: [3,1,15,44.94,-93.1],405: [3,1,8,40.71,-73.99],406: [6,0,4,34.4,-119.72],408: [3,0,19,40.53,-89.35],409: [5,0,1,48.73,-122.48],410: [4,1,2,37.45,-122.17],411: [4,0,4,40.81,-81.93],412: [3,0,4,40.43,-79.97],413: [6,0,4,29.45,-98.5],414: [3,0,15,35.1,-90],415: [4,0,4,32.21,-110.88],416: [3,1,19,33.67,-117.9],417: [3,1,14,42.27,-83.73],418: [6,1,13,39.3,-76.61],419: [4,0,10,39.98,-82.98],421: [4,1,15,44.94,-93.1],422: [3,0,6,38.28,-122],423: [7,0,14,34.18,-118.39],424: [4,1,12,44.96,-93.26],425: [2,0,19,47.13,-102.33],427: [6,0,3,33.56,-111.9],428: [3,0,19,44.96,-93.26],429: [3,0,19,34,-81.03],430: [4,0,18,47.65,-122.4],431: [3,0,12,33.47,-117.7],432: [3,0,6,41.57,-93.61],433: [3,0,2,40.64,-73.94],434: [2,1,19,45.31,-84.45],435: [3,0,5,42,-87.99],436: [4,1,1,40.06,-76.72],437: [3,1,14,38.89,-77.03],438: [6,1,1,39.98,-82.98],439: [3,1,1,38.98,-77.12],440: [4,0,14,42.47,-83.25],441: [6,0,20,45.37,-92.88],442: [3,0,19,33.4,-111.92],443: [4,0,17,26.14,-80.13],444: [6,1,10,43.06,-87.96],445: [3,0,21,33.6,-117.71],446: [6,0,4,42.04,-87.68],447: [4,0,1,44.94,-93.1],448: [3,0,6,40.77,-73.95],449: [3,0,11,44.29,-93.27],450: [4,1,4,40.66,-73.47],451: [2,0,19,43.04,-83.32],452: [4,0,1,35.36,-81.83],454: [6,0,14,44.63,-123.27],455: [5,0,1,43.54,-116.29],456: [3,0,20,32.58,-84.84],457: [4,1,17,34.01,-83.83],459: [3,0,19,34,-81.03],460: [5,1,14,41.83,-87.68],461: [2,0,19,47.63,-122.32],463: [5,1,8,32.79,-96.76],464: [7,0,21,37.78,-121.99],466: [3,0,19,33.78,-118.14],467: [3,0,5,34.17,-118.29],469: [7,0,4,30.64,-97.68],470: [3,0,15,40.77,-73.95],471: [2,0,19,29.57,-95.53],472: [3,0,19,35.89,-106.28],473: [3,0,19,37.9,-122.26],474: [6,0,7,36.84,-119.82],475: [4,0,15,32.79,-96.76],476: [3,0,19,41.7,-88.07],478: [3,0,14,40.71,-73.99],479: [4,0,4,44.96,-93.26],480: [6,0,16,48.41,-122.53],481: [8,0,16,35.8,-84.27],482: [2,1,19,38.22,-85.74],483: [3,0,18,39.98,-82.98],484: [3,0,19,39.39,-76.7],485: [5,1,4,38.62,-121.38],486: [4,0,4,34.41,-119.7],487: [3,0,5,32.9,-117.2],488: [5,0,20,39.04,-76.49],489: [6,0,14,39.09,-84.51],491: [5,1,21,43.07,-89.38],492: [6,0,4,37.84,-122.23],493: [3,0,5,42.13,-87.92],494: [4,1,1,42.9,-85.82],496: [3,1,19,44.96,-93.26],497: [3,0,19,41.74,-92.72],498: [3,0,21,44.96,-93.26],499: [5,0,15,32.98,-96.89],500: [3,0,1,37.41,-122.17],501: [3,0,19,40.71,-73.99],502: [3,0,19,37.59,-76.5],503: [6,1,21,35.92,-79.04],504: [5,1,21,32.75,-117.07],505: [3,1,14,38.41,-76.45],507: [2,1,21,34.31,-78.51],508: [3,0,12,39.95,-75.6],509: [3,0,1,40.71,-73.99],510: [4,0,14,47.4,-121.99],511: [3,0,19,39.3,-76.61],512: [3,0,14,38.89,-77.03],513: [5,0,1,38.92,-79.85],514: [3,0,15,39.09,-76.85],515: [6,0,12,42.96,-85.65],516: [6,1,11,40.77,-73.95],517: [3,0,19,44.96,-93.26],518: [5,1,21,64.9,-148.16],519: [3,0,14,45.41,-94.04],520: [7,0,8,41.69,-73.92],522: [4,0,5,44.96,-93.26],525: [3,1,1,39.67,-75.75],526: [4,0,12,45.58,-122.91],527: [4,0,11,42.73,-73.67],528: [2,0,19,44.94,-93.1],529: [5,1,1,41.17,-81.43],530: [3,0,5,37.38,-122.08],531: [4,1,17,44.13,-123.07],532: [3,0,19,33.76,-117.79],535: [5,1,4,40.02,-105.25],536: [4,0,5,33.85,-84],537: [4,0,5,38.03,-78.48],538: [4,0,18,39.41,-76.38],539: [6,1,1,40.02,-105.25],540: [3,0,5,34.17,-118.29],541: [2,1,19,41.51,-112.04],542: [3,0,19,41.79,-88.01],543: [4,0,18,37.23,-121.82],544: [5,1,14,32.82,-79.86],546: [4,0,7,38.03,-78.48],547: [6,0,4,43.09,-77.51],548: [6,0,21,38.91,-123.58],549: [5,0,18,38.41,-82.57],550: [2,1,19,39.04,-122.93],551: [3,0,15,44.96,-93.26],552: [5,0,14,41.15,-95.92],553: [6,0,4,37.72,-89.21],554: [4,0,18,37.72,-89.21],555: [3,1,4,37.55,-77.46],556: [4,1,4,33.95,-83.39],557: [4,1,21,40.64,-73.94],558: [6,1,21,38.63,-90.24],559: [7,0,7,40.71,-73.99],560: [4,0,19,40.71,-73.99],561: [3,0,5,42.09,-87.98],562: [6,1,1,39.14,-77.21],563: [4,1,11,28.66,-81.32],564: [7,0,16,38.11,-122.2],565: [5,0,19,44.96,-93.26],566: [3,0,19,43.16,-77.61],567: [3,0,6,40.71,-73.99],569: [4,0,4,32.83,-116.76],570: [3,0,4,43.16,-77.61],572: [6,0,4,38.89,-77.03],573: [7,0,16,42.7,-84.55],574: [6,0,4,43.01,-88.23],575: [4,0,12,39.96,-86.1],576: [5,0,7,48.98,-123.05],577: [4,1,19,30.6,-96.31],579: [4,0,4,42.27,-83.73],580: [2,0,19,40.65,-76.1],581: [4,0,14,37.74,-122.44],582: [2,0,19,34.28,-119.22],583: [5,0,5,34.68,-82.81],584: [3,0,19,35.78,-78.79],585: [7,0,11,46.97,-122.87],586: [3,0,19,32.28,-99.83],587: [3,0,14,42.88,-78.85],588: [2,1,19,34.3,-118.72],589: [3,0,10,34.02,-118.39],590: [6,0,4,44.79,-108.73],591: [6,1,11,32.88,-117.23],592: [2,0,19,42.15,-122.53],593: [4,1,4,42.19,-97.52],595: [3,0,15,32.51,-84.87],596: [3,0,2,29.76,-95.38],597: [3,0,14,40.81,-111.94],598: [5,1,12,39.98,-82.98],601: [2,1,2,61.36,-150.07],602: [5,1,14,28.24,-82.71],603: [3,0,15,40.41,-86.87],604: [4,0,4,40.85,-73.21],605: [4,0,5,27.75,-82.64],606: [3,0,15,38.76,-90.42],608: [3,0,14,40.71,-73.99],609: [2,1,19,44.94,-93.1],610: [3,0,19,39.21,-76.72],611: [5,0,11,29.76,-95.38],612: [4,0,4,36.39,-100.8],613: [4,1,12,34.68,-82.95],614: [6,0,4,39.76,-104.87],615: [4,0,4,35.98,-78.91],616: [6,0,18,42.52,-92.45],617: [3,1,21,40.64,-73.94],618: [2,1,19,41.24,-81.82],619: [2,0,19,41.47,-81.67],620: [2,1,21,40.08,-108.77],621: [2,0,19,41.84,-87.79],622: [3,0,15,42.44,-76.5],623: [6,1,4,41.85,-88.1],624: [2,0,19,33.95,-84.54],625: [3,0,15,39.09,-76.85],626: [3,0,18,39.73,-75.53],628: [2,0,13,37.41,-122.13],629: [5,1,14,41.17,-81.43],630: [3,1,8,44.96,-93.26],631: [2,1,19,34.38,-88.68],632: [2,0,19,44.96,-93.26],633: [4,0,15,44.96,-93.26],635: [3,0,14,37.55,-77.46],636: [5,0,4,42.59,-82.88],637: [4,0,14,36.12,-95.91],639: [5,1,11,42.85,-73.8],640: [3,0,19,40.1,-88.2],641: [3,0,19,41.83,-87.68],642: [2,1,19,40.85,-124.05],643: [4,0,18,44.94,-93.1],644: [6,0,16,37.56,-90.29],645: [3,0,15,43.06,-87.96],646: [2,1,19,43.07,-96.17],647: [5,0,4,40.76,-83.82],648: [5,0,5,34.43,-118.46],649: [3,0,19,33.45,-88.79],650: [5,0,5,47.59,-116.91],652: [4,0,14,38.03,-78.48],653: [4,0,7,44.94,-93.1],654: [3,1,19,30.26,-97.74],655: [6,1,8,41.83,-87.68],656: [5,0,4,40.58,-74.14],657: [3,1,13,30.26,-97.74],658: [4,0,15,33.67,-117.9],659: [4,0,4,44.14,-87.82],660: [3,0,19,30.06,-95.38],661: [3,0,15,47.61,-122.34],662: [6,0,11,39.95,-75.16],663: [3,0,14,40.03,-75.63],664: [4,0,5,37.78,-122.43],665: [3,0,1,44.96,-93.26],666: [5,0,1,40.11,-88.26],668: [3,1,21,40.71,-73.99],669: [4,0,14,38.89,-77.03],670: [4,0,20,39.01,-76.68],671: [3,0,15,32.62,-116.67],672: [6,1,1,34.07,-118.44],673: [6,0,4,38.03,-78.48],674: [2,1,19,44.76,-93.27],675: [4,0,14,35.57,-82.54],676: [4,0,15,28.68,-81.51],677: [3,0,14,56.73,-135],678: [6,0,4,40.91,-90.64],679: [3,1,19,44.52,-87.98],680: [4,0,10,34.01,-118.46],681: [5,1,12,45.53,-122.56],682: [3,0,15,44.94,-93.1],683: [5,0,11,36.84,-76.28],684: [3,0,19,44.96,-93.26],685: [4,1,11,44.96,-93.26],686: [4,0,4,39.63,-79.94],687: [4,1,8,35.98,-78.91],688: [4,1,1,41.57,-87.61],689: [3,0,14,39.77,-84.19],690: [4,0,17,38.79,-90.51],691: [4,0,4,42.16,-87.96],692: [4,0,5,40.72,-75.71],693: [5,1,8,33.38,-111.84],695: [3,0,21,35.1,-90],696: [6,0,14,37.89,-122.47],697: [3,0,14,29.76,-95.38],699: [5,0,14,22.21,-159.41],700: [2,0,19,33.89,-98.51],701: [6,1,11,45.64,-94.31],702: [4,0,14,36.15,-115.11],703: [3,0,4,42.96,-85.65],704: [6,1,11,34.14,-118.16],705: [3,1,19,44.39,-89.83],706: [3,0,19,44.96,-93.26],707: [6,1,11,39.95,-75.16],708: [3,1,9,0,0],710: [2,0,19,32.79,-116.96],711: [3,1,19,40.43,-79.97],712: [3,1,19,44.01,-88.55],714: [3,0,5,44.92,-93.4],715: [3,0,20,34.16,-118.2],716: [4,1,1,41.03,-81.24],717: [3,0,20,40.73,-111.85],718: [5,0,20,39.09,-94.58],720: [5,1,1,42.12,-80.08],721: [3,1,6,40.64,-73.94],722: [6,1,9,39.81,-76.98],723: [3,0,7,37.54,-122.3],724: [4,0,7,38.22,-85.74],725: [3,0,19,34.12,-117.71],726: [3,1,1,40.41,-105.07],727: [3,0,19,30.26,-97.74],728: [6,0,7,37.41,-122.13],729: [2,0,19,46.51,-95.37],730: [4,1,18,29.19,-81.05],731: [5,1,4,30.5,-90.46],732: [3,1,14,47.24,-122.47],733: [5,1,14,41.83,-87.68],734: [3,1,14,38.63,-90.24],735: [3,1,8,32.24,-110.95],736: [5,1,21,37.84,-122.23],737: [4,0,15,47.75,-122.09],738: [4,0,20,38.5,-122.76],739: [4,0,20,35.46,-97.51],740: [3,1,4,38.87,-77.1],741: [3,0,21,38.63,-90.24],742: [4,0,19,34,-81.03],743: [4,0,15,33.62,-117.87],744: [4,0,12,39.5,-85.18],745: [5,0,21,44.94,-93.1],746: [3,0,5,40.17,-74.91],747: [2,0,14,36.81,-119.71],748: [3,0,1,37.86,-122.25],749: [4,0,14,38.86,-104.76],750: [3,0,1,30.45,-84.28],751: [3,1,14,34.02,-118.39],752: [7,0,16,39.3,-76.61],753: [6,0,17,34.16,-118.2],754: [6,1,11,37.72,-89.21],755: [5,1,4,45.44,-122.88],756: [4,1,13,33.89,-118.29],757: [3,0,19,44.94,-93.1],758: [3,0,19,43.07,-89.38],759: [3,1,19,40.81,-96.68],760: [4,1,14,42.88,-78.85],761: [2,0,19,44.9,-123.06],762: [4,0,1,37.34,-121.95],764: [3,1,4,37.72,-89.21],765: [4,0,19,26.23,-80.13],766: [5,0,14,41.09,-73.91],768: [3,0,1,43.06,-73.77],770: [3,0,19,42.88,-78.85],771: [3,0,19,40.43,-79.97],772: [6,0,21,36.1,-80.24],773: [3,0,19,44.96,-93.26],774: [4,0,19,39.96,-105.14],775: [5,0,7,34.06,-118.35],776: [4,0,11,42.5,-96.39],780: [5,0,15,37.51,-122.04],781: [3,0,19,42.73,-84.48],782: [3,1,2,25.77,-80.2],783: [4,0,12,29.76,-95.38],784: [5,0,1,34.26,-118.32],785: [4,0,5,36.67,-76.3],787: [2,1,19,45.84,-120.76],789: [3,0,14,44.96,-93.26],790: [3,0,20,38.86,-104.76],791: [4,0,4,38.89,-77.03],792: [5,0,15,42.66,-73.79],793: [3,0,19,33.43,-111.91],794: [4,0,4,43.54,-96.73],796: [4,1,21,27.97,-82.76],797: [5,1,14,39.85,-88.93],798: [5,1,21,39.09,-94.58],799: [5,1,1,39.67,-75.75],800: [3,0,15,44.76,-93.27],801: [3,0,21,32.56,-117.01],802: [4,0,1,26.14,-81.79],803: [8,0,1,29.45,-98.5],804: [4,0,4,40.11,-88.26],805: [3,1,14,38.89,-77.03],806: [3,0,12,40.64,-73.94],807: [5,1,8,35.55,-117.67],808: [5,0,17,34.02,-118.35],809: [6,1,12,33.19,-82.52],810: [6,1,14,40.55,-105.06],811: [5,1,4,35.67,-97.41],812: [3,0,20,33.23,-97.59],814: [4,0,14,42.8,-73.92],815: [4,0,14,35.57,-82.54],816: [4,0,14,39.08,-76.76],817: [2,0,19,42.24,-88.6],818: [3,0,11,35.92,-79.04],819: [6,0,1,38.22,-85.74],820: [3,0,19,36.02,-83.41],821: [4,0,5,30.6,-96.31],822: [3,1,11,42.58,-87.85],823: [3,0,2,41.63,-93.74],824: [4,0,14,40.35,-80.1],826: [3,0,2,29.76,-95.38],827: [3,1,5,39.76,-104.87],828: [3,0,11,33.4,-111.92],829: [5,0,21,39.76,-104.87],830: [5,0,15,43.1,-88.49],831: [3,0,14,27.97,-82.76],832: [3,0,20,29.76,-95.38],833: [4,0,21,34.04,-118.34],834: [3,0,14,39.09,-94.58],835: [5,1,7,40.77,-73.64],836: [5,0,2,40.71,-73.99],837: [4,1,2,44.96,-93.26],839: [4,1,6,33.77,-118.14],840: [4,0,2,44.96,-93.26],841: [5,0,3,39.16,-86.52],842: [5,0,21,34.15,-119.19],843: [4,0,11,41.24,-81.82],844: [3,0,5,38.68,-121.22],845: [7,0,3,43.92,-123.08],846: [3,0,10,38.3,-85.72],847: [3,0,19,44.96,-93.26],849: [2,1,19,37.81,-82.03],850: [4,0,20,27.98,-97.39],851: [2,0,14,34.19,-82.15],852: [5,0,1,37.36,-122.02],853: [5,0,21,38.04,-84.45],854: [3,1,19,44.96,-93.26],856: [5,1,12,45.51,-122.59],860: [8,1,16,42.56,-83.38],861: [4,1,19,42.71,-78.93],862: [3,0,7,42.45,-75.06],863: [2,0,19,42.16,-87.96],864: [3,0,15,38.59,-90.55],865: [3,0,2,40.64,-73.94],866: [5,0,14,41.88,-87.78],867: [3,0,18,33.96,-117.31],868: [3,0,15,45.21,-93.39],869: [4,0,19,40.71,-73.99],870: [3,0,19,38.95,-92.32],871: [4,0,7,40.78,-81.52],872: [2,1,19,36.13,-97.07],873: [5,1,1,27.97,-82.76],874: [4,0,18,36.13,-86.58],875: [3,1,19,34.7,-86.62],876: [5,0,14,39.01,-77.02],877: [4,0,14,29.66,-95.15],878: [6,1,4,47.5,-122],879: [4,1,1,44.76,-93.27],880: [2,0,19,43.71,-116.18],881: [4,0,12,40.11,-83.13],882: [4,0,5,38.04,-84.45],883: [5,0,11,41.57,-93.75],884: [5,0,5,44.76,-93.27],885: [4,1,14,37.54,-120.68],886: [3,0,19,40.11,-88.26],887: [2,1,19,36.1,-79.54],888: [5,0,18,40.26,-76.71],889: [3,0,20,30.26,-97.74],890: [4,0,19,44.9,-122.92],892: [4,0,14,39.09,-84.51],893: [3,0,19,38.47,-121.44],894: [5,0,4,36.13,-97.07],895: [4,1,11,30.45,-84.28],896: [3,0,21,34.17,-118.34],897: [4,0,14,26.45,-80.08],898: [3,0,9,40.53,-89.35],899: [4,0,14,44.94,-93.1],900: [7,0,16,41.4,-75.66],902: [5,1,2,45.61,-122.74],903: [3,0,4,39.08,-77.15],904: [2,1,19,42.41,-89],905: [3,0,14,33.97,-84.32],906: [5,0,11,30.06,-89.93],907: [3,1,14,40.55,-105.06],908: [5,1,11,40.81,-96.68],909: [6,1,4,42.58,-87.89],910: [3,0,8,34.94,-81.92],911: [4,1,21,43.06,-87.96],913: [3,0,19,33.21,-97.13],915: [6,0,6,41.83,-87.68],917: [3,1,19,38.89,-77.03],918: [5,0,18,30.06,-89.93],919: [3,0,14,42.88,-78.85],920: [4,1,2,34,-118.34],921: [3,1,19,47.37,-120.35],922: [3,1,1,39.01,-76.68],924: [3,0,14,40.78,-73.54],925: [2,1,17,41.94,-85],927: [3,0,15,44.96,-93.26],928: [3,0,19,44.96,-93.26],929: [5,0,18,43.07,-89.38],931: [7,0,4,28.2,-82.59],933: [3,0,19,42.27,-83.73],934: [7,0,5,38.03,-78.48],935: [5,0,3,38.9,-94.68],936: [3,0,14,28.59,-81.34],937: [5,0,4,47.75,-122.09],938: [4,1,20,45.15,-92.96],939: [3,1,19,26.14,-80.13],941: [3,0,19,45.55,-122.81],942: [5,1,11,29.45,-98.5],943: [3,0,19,30.6,-96.31]}

# <codecell>

import math
math.pi

# <codecell>

# Four things to compare (age, sex, occupation, location) so gave weight of 25 to each
weight = 25.0

#Calculates distance between two locations. Found this code online
def distancebetween(lat1,lat2,lon1,lon2):
    R = 6371 #Radius of the earth in k
    dLat = (lat2-lat1) * math.pi / 180  
    dLon = (lon2-lon1) * math.pi / 180 
    a = math.sin(dLat/2) * math.sin(dLat/2) + math.cos(lat1 * math.pi / 180) * math.cos(lat2 * math.pi / 180) * math.sin(dLon/2) * math.sin(dLon/2) 
    c = 2 * math.atan2(math.sqrt(a), math.sqrt(1-a))
    d = R * c * .621371  # Convert to Distance in miles
    return d

#Calculates the similarity between two users
def similarity(user1,user2):
    age_dist = abs(user1[0]-user2[0]) * weight/7  #distance between two peoples ages
    gender_dist =  int(not (user1[1] == user2[1])) * weight
    occ_sim = int(not (user1[2] == user2[2])) * weight
    dist = distancebetween(user1[3],user2[3],user1[4],user2[4])
    if dist <= 50:
        dist_score = 0 * weight/2
    elif dist > 50 and dist <=100:
        dist_score = 1 * weight/2
    else:
        dist_score = 2 * weight/2
    
    return [age_dist, gender_dist, occ_sim, dist_score]

#new list to hold distances
pair_distances = []

#Get similarity between each of the pairs in the pairlist
for i in pairlist:
    pair_distances.append( sum((similarity(user_data[i[0]], user_data[i[1]]))) )

# <codecell>

#Check that length is same as original pair list
#len(pair_distances)

# <codecell>

#Writes pairs to a file
f = open('pairs.txt','w')
for i in pairlist:
    f.write(str(i[0]) + '|' + str(i[1]) + "\n")
f.close()

# <codecell>

#Writes output to a file. The output is one distance per line which corresponds to the pairs.txt file
f = open('output.txt', 'w')
for i in pair_distances:
    f.write(str(i)+"\n")
f.close()

